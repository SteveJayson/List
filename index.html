<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Food Price List</title>
    <style>
        /* --- CSS STYLES --- */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        #add-form, #search-bar {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #e9e9e9;
            margin-bottom: 20px;
        }
        #add-form {
            display: flex;
            gap: 10px;
        }
        #add-form input, #search-input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            flex-grow: 1;
        }
        #add-form button {
            padding: 8px 15px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #add-form button:hover {
            background-color: #218838;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #007bff;
            color: white;
            cursor: pointer;
            user-select: none; /* Prevents text selection on header click */
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .actions button {
            padding: 5px 10px;
            margin-right: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: opacity 0.3s;
        }
        .actions button:hover {
            opacity: 0.8;
        }
        .edit-btn {
            background-color: #ffc107;
            color: #333;
        }
        .delete-btn {
            background-color: #dc3545;
            color: white;
        }
        .save-btn {
            background-color: #17a2b8;
            color: white;
            display: none; /* Hidden by default */
        }
        .editable-input {
            width: calc(100% - 10px);
            padding: 8px 5px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }
        #search-input {
            width: 100%; 
            padding: 10px; 
        }
        /* Custom style for the Peso sign to ensure it displays correctly */
        .peso {
            font-family: Arial, sans-serif; /* Use a font that supports the sign */
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üõí Interactive Food Price List</h1>
    
    <div id="add-form">
        <input type="text" id="food-name" placeholder="Food Name (e.g., Rice)" required>
        <input type="number" id="food-price" placeholder="Price (e.g., 55.00)" step="0.01" required>
        <button onclick="addItem()">‚ûï Add Item</button>
    </div>
    
    <div id="search-bar">
        <input type="text" id="search-input" onkeyup="searchItems()" placeholder="üîç Search for food items...">
    </div>

    <table>
        <thead>
            <tr>
                <th onclick="sortTable(0)">Item Name</th>
                <th onclick="sortTable(1)">Price (<span class="peso">‚Ç±</span>)</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="food-list">
            </tbody>
    </table>
</div>

<script>
    /* --- JAVASCRIPT LOGIC --- */

    const foodListBody = document.getElementById('food-list');
    const nameInput = document.getElementById('food-name');
    const priceInput = document.getElementById('food-price');
    const currencySymbol = '‚Ç±'; // Philippine Peso Symbol

    // Load from Local Storage or use updated Peso defaults
    let foodItems = JSON.parse(localStorage.getItem('foodPrices')) || [
        { name: 'Rice (Kilo)', price: 55.00 },
        { name: 'Eggs (Dozen)', price: 90.00 },
        { name: 'Chicken (Kilo)', price: 180.00 },
    ];
    let sortDirection = 1; 

    /**
     * Saves the current foodItems array to the browser's Local Storage.
     */
    function saveItems() {
        localStorage.setItem('foodPrices', JSON.stringify(foodItems));
        console.log('Data saved automatically to Local Storage.');
    }

    /**
     * Renders the HTML table rows based on the itemsToRender array.
     */
    function renderList(itemsToRender) {
        foodListBody.innerHTML = ''; 

        itemsToRender.forEach((item, index) => {
            // Find the original index in the main foodItems array
            const originalIndex = foodItems.findIndex(f => f === item);
            
            const row = foodListBody.insertRow();
            row.setAttribute('data-index', originalIndex); 

            // Item Name Cell (Editable display)
            let cellName = row.insertCell(0);
            cellName.innerHTML = `<span id="name-${originalIndex}">${item.name}</span>`;

            // Price Cell (Editable display) - Peso formatting applied here
            let cellPrice = row.insertCell(1);
            cellPrice.innerHTML = `<span class="peso">${currencySymbol}</span> <span id="price-${originalIndex}">${item.price.toFixed(2)}</span>`;

            // Actions Cell
            let cellActions = row.insertCell(2);
            cellActions.className = 'actions';
            cellActions.innerHTML = `
                <button class="edit-btn" id="edit-btn-${originalIndex}" onclick="startEdit(${originalIndex})">‚úèÔ∏è Edit</button>
                <button class="save-btn" id="save-btn-${originalIndex}" onclick="saveEdit(${originalIndex})">üíæ Save</button>
                <button class="delete-btn" onclick="deleteItem(${originalIndex})">üóëÔ∏è Delete</button>
            `;
        });
    }

    /**
     * Adds a new item from the input fields to the list.
     */
    function addItem() {
        const name = nameInput.value.trim();
        const price = parseFloat(priceInput.value);

        if (name && !isNaN(price) && price >= 0) {
            foodItems.push({ name: name, price: price });
            
            // Clear inputs
            nameInput.value = '';
            priceInput.value = '';
            
            // Re-render the full list (clearing search results) and save
            document.getElementById('search-input').value = '';
            renderList(foodItems);
            saveItems(); 
        } else {
            alert('Please enter a valid item name and price.');
        }
    }

    /**
     * Deletes an item from the list by its index.
     */
    function deleteItem(indexToDelete) {
        if (confirm(`Are you sure you want to delete "${foodItems[indexToDelete].name}"?`)) {
            foodItems.splice(indexToDelete, 1);
            
            // Re-render the full list and save
            renderList(foodItems);
            saveItems();
        }
    }

    /**
     * Replaces the displayed text with input fields for editing.
     */
    function startEdit(index) {
        const item = foodItems[index];
        const nameSpan = document.getElementById(`name-${index}`);
        const priceSpan = document.getElementById(`price-${index}`);
        const editButton = document.getElementById(`edit-btn-${index}`);
        const saveButton = document.getElementById(`save-btn-${index}`);

        // Replace spans with input fields
        nameSpan.innerHTML = `<input type="text" id="edit-name-${index}" value="${item.name}" class="editable-input">`;
        // Include the Peso sign outside the input field for visual clarity
        priceSpan.innerHTML = `<span class="peso">${currencySymbol}</span> <input type="number" id="edit-price-${index}" value="${item.price.toFixed(2)}" step="0.01" class="editable-input" style="width: calc(100% - 20px);">`;
        
        // Toggle buttons
        editButton.style.display = 'none';
        saveButton.style.display = 'inline-block';
    }

    /**
     * Saves the changes from the input fields back to the list.
     */
    function saveEdit(index) {
        const newNameInput = document.getElementById(`edit-name-${index}`);
        const newPriceInput = document.getElementById(`edit-price-${index}`);
        
        const newName = newNameInput.value.trim();
        const newPrice = parseFloat(newPriceInput.value);

        if (newName && !isNaN(newPrice) && newPrice >= 0) {
            // Update the array item
            foodItems[index].name = newName;
            foodItems[index].price = newPrice;
            
            // Re-render the full list and save
            renderList(foodItems);
            saveItems();

        } else {
            alert('Invalid input. Changes not saved.');
            // Just re-render to revert the HTML input fields back to text
            renderList(foodItems);
        }
    }

    /**
     * Filters the list based on the search input value.
     */
    function searchItems() {
        const searchTerm = document.getElementById('search-input').value.toLowerCase();
        
        const filteredItems = foodItems.filter(item => {
            return item.name.toLowerCase().includes(searchTerm);
        });

        renderList(filteredItems);
    }
    
    /**
     * Sorts the foodItems array by the specified column index (0 for name, 1 for price).
     */
    function sortTable(columnIndex) {
        foodItems.sort((a, b) => {
            let valA, valB;

            if (columnIndex === 0) { // Sort by Name (String)
                valA = a.name.toLowerCase();
                valB = b.name.toLowerCase();
                if (valA < valB) return -1 * sortDirection;
                if (valA > valB) return 1 * sortDirection;
                return 0;
            } else if (columnIndex === 1) { // Sort by Price (Number)
                valA = a.price;
                valB = b.price;
                return (valA - valB) * sortDirection;
            }
            return 0;
        });

        // Reverse direction for next click
        sortDirection = -sortDirection;
        
        // Re-render the sorted list
        renderList(foodItems);
    }

    // --- Initial Load ---
    document.addEventListener('DOMContentLoaded', () => {
        // Load the initial list from storage when the page loads
        renderList(foodItems);
    });

</script>

</body>
</html>